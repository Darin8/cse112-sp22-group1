(()=>{"use strict";var e={d:(t,o)=>{for(var s in o)e.o(o,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:o[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};function t(){let e=[],t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",o=t.length;for(let s=0;s<30;s++)e.push(t.charAt(Math.floor(Math.random()*o)));return e.join("")}e.d({},{zm:()=>Me,BJ:()=>Ce,Fs:()=>Se,mx:()=>Ie,CO:()=>Ee,oT:()=>_e,nv:()=>Ne,Lu:()=>Re,Dh:()=>He,HQ:()=>De});let o={},s={},l={},n=!1;function i(e,s,l,n,r){let a=new Date(s.getFullYear(),s.getMonth(),e);e>l?r([]):function(e,s,l,n,i,r){!function(e,s,l,n,i,r){e.get("0000",((a,c)=>{if(!a){let a=t(),d=[];for(Array.prototype.push.apply(d,c.dailyLogs),Array.prototype.push.apply(d,c.monthlyLogs),Array.prototype.push.apply(d,c.futureLogs),Array.prototype.push.apply(d,c.collections),Array.prototype.push.apply(d,c.trackers),Array.prototype.push.apply(d,c.textBlocks),Array.prototype.push.apply(d,c.tasks),Array.prototype.push.apply(d,c.events),Array.prototype.push.apply(d,c.signifiers),Array.prototype.push.apply(d,c.imageBlocks),Array.prototype.push.apply(d,c.audioBlocks);d.filter((e=>e.id===a)).length>0;)a=t();return o={id:a,objectType:"dailyLog",date:i,parent:s,content:l,trackers:n},c.dailyLogs.push(o),e.put({_id:"0000",_rev:c._rev,email:c.email,pwd:c.pwd,theme:c.theme,index:c.index,dailyLogs:c.dailyLogs,monthlyLogs:c.monthlyLogs,futureLogs:c.futureLogs,collections:c.collections,trackers:c.trackers,imageBlocks:c.imageBlocks,audioBlocks:c.audioBlocks,textBlocks:c.textBlocks,tasks:c.tasks,events:c.events,signifiers:c.signifiers}).then((e=>{console.log(e)})).catch((e=>{r(e,null)}))}r(a,null)})).then((e=>{e.ok&&r(null,o)}))}(m,e,[],[],n,((e,t)=>{r(e,t)}))}(n.id,0,0,a,0,((t,o)=>{null===t?i(e+1,s,l,n,(e=>{e.splice(0,0,{id:o.id,content:[],dailyLog:o.id}),r(e)})):console.log(t)}))}let r={};function a(e,o,s,c){let d=e,h=d.getTime()===r.startDate.getTime()?new Date(d.getFullYear(),d.getMonth(),d.getUTCDate()):new Date(d.getFullYear(),d.getMonth()+1,0);d.getMonth()===o.getMonth()&&(h=new Date(o.getFullYear(),o.getMonth(),o.getUTCDate())),function(e,o,s,r,a,c,d){!function(e,o,s,r,a,c,d){e.get("0000",((n,i)=>{if(!n){let n=t(),d=[];for(Array.prototype.push.apply(d,i.dailyLogs),Array.prototype.push.apply(d,i.monthlyLogs),Array.prototype.push.apply(d,i.futureLogs),Array.prototype.push.apply(d,i.collections),Array.prototype.push.apply(d,i.trackers),Array.prototype.push.apply(d,i.textBlocks),Array.prototype.push.apply(d,i.tasks),Array.prototype.push.apply(d,i.events),Array.prototype.push.apply(d,i.signifiers),Array.prototype.push.apply(d,i.imageBlocks),Array.prototype.push.apply(d,i.audioBlocks);d.filter((e=>e.id===n)).length>0;)n=t();return l={id:n,objectType:"monthlyLog",date:c,parent:o,content:s,days:r,trackers:a},i.monthlyLogs.push(l),e.put({_id:"0000",_rev:i._rev,email:i.email,pwd:i.pwd,theme:i.theme,index:i.index,dailyLogs:i.dailyLogs,monthlyLogs:i.monthlyLogs,futureLogs:i.futureLogs,collections:i.collections,trackers:i.trackers,imageBlocks:i.imageBlocks,audioBlocks:i.audioBlocks,textBlocks:i.textBlocks,tasks:i.tasks,events:i.events,signifiers:i.signifiers})}d(n,null)})).then((t=>{if(t.ok){let t=l.date.getDate()!==new Date(l.date.getFullYear(),l.date.getMonth()+1,0).getDate()&&n,o=new Date(l.date.getFullYear(),t?l.date.getMonth():l.date.getMonth()+1,t?l.date.getDate():0);console.log(o);let s=o.getDate(),r=1;n||(r=l.date.getDate(),n=!0),i(r,new Date(l.date),s,l,(t=>{l.days=t,e.get("0000",((t,o)=>{o.monthlyLogs[o.monthlyLogs.length-1]=l,e.put({_id:"0000",_rev:o._rev,email:o.email,pwd:o.pwd,theme:o.theme,index:o.index,dailyLogs:o.dailyLogs,monthlyLogs:o.monthlyLogs,futureLogs:o.futureLogs,collections:o.collections,trackers:o.trackers,imageBlocks:o.imageBlocks,audioBlocks:o.audioBlocks,textBlocks:o.textBlocks,tasks:o.tasks,events:o.events,signifiers:o.signifiers}).then((e=>{e.ok&&d(null,l)})).catch((e=>{d(e,null)}))}))}))}})).catch((e=>{d(e,null)}))}(m,e,[],[],[],a,((e,t)=>{d(e,t)}))}(s.id,0,0,0,h,0,((e,t)=>{if(null===e)if(d.getMonth()>o.getMonth())c([]);else{d.getDate()!==new Date(d.getFullYear(),d.getMonth()+1,0).getDate()&&(d=new Date(d.getFullYear(),d.getMonth()+1,0));let e=new Date(d);e.setMonth(d.getMonth()+1),d.getDate()!==e.getDate()?e.setDate(0):e.getDate()!==new Date(e.getFullYear(),e.getMonth()+1,0).getDate()&&(e=new Date(e.getFullYear(),e.getMonth()+1,0)),a(e,o,s,(e=>{e.splice(0,0,{id:t.id,content:[],monthlyLog:t.id}),c(e)}))}else console.log(e)}))}let c={},d={},h={};function u(e,t,o){console.log("deleteEvent"+t),e.get("0000",((s,l)=>{if(!s){let s=l.events.filter((e=>e.id===t)),n=null;s.length>0&&(n=s[0]),console.log(n);let i=[];Array.prototype.push.apply(i,l.textBlocks);let r=l.events.filter((e=>e.id!==t));return e.put({_id:"0000",_rev:l._rev,email:l.email,pwd:l.pwd,theme:l.theme,index:l.index,dailyLogs:l.dailyLogs,monthlyLogs:l.monthlyLogs,futureLogs:l.futureLogs,trackers:l.trackers,collections:l.collections,imageBlocks:l.imageBlocks,audioBlocks:l.audioBlocks,textBlocks:l.textBlocks,tasks:l.tasks,events:r,signifiers:l.signifiers},((e,t)=>{e?o(e):(console.log(t),o(null))}))}o(s)}))}function p(e,t,o){e.get("0000",((s,l)=>{if(!s){let s=l.tasks.filter((e=>e.id!==t));return e.put({_id:"0000",_rev:l._rev,email:l.email,pwd:l.pwd,theme:l.theme,index:l.index,dailyLogs:l.dailyLogs,monthlyLogs:l.monthlyLogs,futureLogs:l.futureLogs,trackers:l.trackers,collections:l.collections,imageBlocks:l.imageBlocks,audioBlocks:l.audioBlocks,textBlocks:l.textBlocks,tasks:s,events:l.events,signifiers:l.signifiers},((e,t)=>{e?o(e):(console.log(t),o(null))}))}o(s)}))}function g(e,t,o,s){v(((l,n)=>{if(null===l){let l=[];Array.prototype.push.apply(l,n.dailyLogs),Array.prototype.push.apply(l,n.monthlyLogs),Array.prototype.push.apply(l,n.futureLogs),Array.prototype.push.apply(l,n.trackers),Array.prototype.push.apply(l,n.collections);let i=l.filter((e=>e.id===t.parent))[0];if("dailyLog"===i.objectType){let e=i.content.filter((e=>e!==o));i.content=e}else if("monthlyLog"===i.objectType){for(let e=0;e<i.days.length;e++)if(i.days[e].content.includes(o)){let t=i.days[e].content.filter((e=>e!==o));i.days[e].content=t}}else if("futureLog"===i.objectType)for(let e=0;e<i.months.length;e++)if(i.months[e].content.includes(o)){let t=i.months[e].content.filter((e=>e!==o));i.months[e].content=t}let r=n.textBlocks.filter((e=>e.id!==o));return n.textBlocks=r,e.put({_id:"0000",_rev:n._rev,email:n.email,pwd:n.pwd,theme:n.theme,index:n.index,dailyLogs:n.dailyLogs,monthlyLogs:n.monthlyLogs,futureLogs:n.futureLogs,collections:n.collections,trackers:n.trackers,imageBlocks:n.imageBlocks,audioBlocks:n.audioBlocks,textBlocks:n.textBlocks,tasks:n.tasks,events:n.events,signifiers:n.signifiers}).then((e=>{console.log(e),s(null)})).catch((e=>{console.log(e),s(e)}))}console.log(l),s(l)}))}function y(e,t,o){v(((s,l)=>{if(null===s)return e.put({_id:"0000",_rev:l._rev,email:l.email,pwd:l.pwd,theme:l.theme,index:l.index,dailyLogs:l.dailyLogs,monthlyLogs:l.monthlyLogs,futureLogs:l.futureLogs,trackers:l.trackers,collections:l.collections,imageBlocks:l.imageBlocks,audioBlocks:l.audioBlocks,textBlocks:t,tasks:l.tasks,events:l.events,signifiers:l.signifiers},((e,t)=>{e?(console.log(e),o(e)):o(t)}));console.log(s),o(s)}))}let m=new PouchDB("Users");function f(){!function(e,t){console.trace(),e.get("0000",((e,t)=>{if(e)o=e,console.log(o);else try{console.log(t),fetch("https://boojo.bitfrost.app/api/updateUser",{headers:{"content-type":"application/json; charset=UTF-8",Origin:"https://boojo.bitfrost.app"},body:JSON.stringify(t),method:"POST"}).then((e=>e.json())).then((e=>{console.log(e)}))}catch(e){console.log(e.text)}var o}))}(m)}function k(e,o,l,n,i,r){!function(e,o,l,n,i,r){e.get("0000",((a,c)=>{if(!a){console.log(c);let a=t(),d=[];for(Array.prototype.push.apply(d,c.dailyLogs),Array.prototype.push.apply(d,c.monthlyLogs),Array.prototype.push.apply(d,c.futureLogs),Array.prototype.push.apply(d,c.collections),Array.prototype.push.apply(d,c.trackers),Array.prototype.push.apply(d,c.textBlocks),Array.prototype.push.apply(d,c.tasks),Array.prototype.push.apply(d,c.events),Array.prototype.push.apply(d,c.signifiers),Array.prototype.push.apply(d,c.imageBlocks),Array.prototype.push.apply(d,c.audioBlocks);d.filter((e=>e.id===a)).length>0;)a=t();return s={id:a,objectType:"event",title:o,parent:l,date:n,signifier:i},c.events.push(s),e.put({_id:"0000",_rev:c._rev,email:c.email,pwd:c.pwd,theme:c.theme,index:c.index,dailyLogs:c.dailyLogs,monthlyLogs:c.monthlyLogs,futureLogs:c.futureLogs,collections:c.collections,trackers:c.trackers,imageBlocks:c.imageBlocks,audioBlocks:c.audioBlocks,textBlocks:c.textBlocks,tasks:c.tasks,events:c.events,signifiers:c.signifiers}).then((e=>{console.log(e)})).catch((e=>{r(e,null)}))}r(a,null)})).then((e=>{e.ok&&r(null,s)}))}(m,e,o,l,n,((e,t)=>{i&&f(),r(e,t)}))}function b(e,o,s,l,n,i){!function(e,o,s,l,n,i){e.get("0000",((r,a)=>{if(!r){console.log(a);let r=t(),d=[];for(Array.prototype.push.apply(d,a.dailyLogs),Array.prototype.push.apply(d,a.monthlyLogs),Array.prototype.push.apply(d,a.futureLogs),Array.prototype.push.apply(d,a.collections),Array.prototype.push.apply(d,a.trackers),Array.prototype.push.apply(d,a.textBlocks),Array.prototype.push.apply(d,a.tasks),Array.prototype.push.apply(d,a.events),Array.prototype.push.apply(d,a.signifiers),Array.prototype.push.apply(d,a.imageBlocks),Array.prototype.push.apply(d,a.audioBlocks);d.filter((e=>e.id===r)).length>0;)r=t();return c={id:r,objectType:"task",parent:o,text:s,complete:l,signifier:n},a.tasks.push(c),e.put({_id:"0000",_rev:a._rev,email:a.email,pwd:a.pwd,theme:a.theme,index:a.index,dailyLogs:a.dailyLogs,monthlyLogs:a.monthlyLogs,futureLogs:a.futureLogs,collections:a.collections,trackers:a.trackers,imageBlocks:a.imageBlocks,audioBlocks:a.audioBlocks,textBlocks:a.textBlocks,tasks:a.tasks,events:a.events,signifiers:a.signifiers}).then((e=>{console.log(e)})).catch((e=>{console.log(e),i(e,null)}))}i(r,null)})).then((e=>{console.log(e),i(null,c)}))}(m,e,o,s,l,((e,t)=>{n&&f(),i(e,t)}))}function L(e,o,s,l,n){!function(e,o,s,l,n){console.log("making tracjer"),e.get("0000",((i,r)=>{if(!i){let i=t(),a=[];for(Array.prototype.push.apply(a,r.dailyLogs),Array.prototype.push.apply(a,r.monthlyLogs),Array.prototype.push.apply(a,r.futureLogs),Array.prototype.push.apply(a,r.collections),Array.prototype.push.apply(a,r.trackers),Array.prototype.push.apply(a,r.textBlocks),Array.prototype.push.apply(a,r.tasks),Array.prototype.push.apply(a,r.events),Array.prototype.push.apply(a,r.signifiers),Array.prototype.push.apply(a,r.imageBlocks),Array.prototype.push.apply(a,r.audioBlocks);a.filter((e=>e.id===i)).length>0;)i=t();h={id:i,objectType:"tracker",title:o,content:s,parent:l},console.log(a),console.log(l);let c=a.filter((e=>e.id===l));return console.log(c),c[0].trackers.push(h.id),r.trackers.push(h),e.put({_id:"0000",_rev:r._rev,email:r.email,pwd:r.pwd,theme:r.theme,index:r.index,dailyLogs:r.dailyLogs,monthlyLogs:r.monthlyLogs,futureLogs:r.futureLogs,collections:r.collections,trackers:r.trackers,imageBlocks:r.imageBlocks,audioBlocks:r.audioBlocks,textBlocks:r.textBlocks,tasks:r.tasks,events:r.events,signifiers:r.signifiers}).then((e=>{console.log(e)})).catch((e=>{console.log(e),n(e,null)}))}n(i,null)})).then((e=>{console.log(e),console.log(h),n(null,h)}))}(m,e,o,s,((e,t)=>{l&&f(),n(e,t)}))}function v(e){!function(e,t){e.get("0000",((e,o)=>{e?t(e,null):t(null,o)}))}(m,((t,o)=>{e(t,o)}))}function w(e,t,o){u(m,e.id,(e=>{t&&f(),o(e)}))}function B(e,t,o){u(m,e,(e=>{t&&f(),o(e)}))}function A(e,t,o){p(m,e.id,(e=>{t&&f(),o(e)}))}function x(e,t,o){p(m,e,(e=>{t&&f(),o(e)}))}function T(e,t,o){!function(e,t,o){console.log(t),e.get("0000",((s,l)=>{if(!s){let s=l.events.filter((e=>e.id!==t.id));return s.push(t),e.put({_id:"0000",_rev:l._rev,email:l.email,pwd:l.pwd,theme:l.theme,index:l.index,dailyLogs:l.dailyLogs,monthlyLogs:l.monthlyLogs,futureLogs:l.futureLogs,trackers:l.trackers,collections:l.collections,imageBlocks:l.imageBlocks,audioBlocks:l.audioBlocks,textBlocks:l.textBlocks,tasks:l.tasks,events:s,signifiers:l.signifiers},((e,t)=>{e?(console.log(e),o(e)):o(t)}))}o(s)}))}(m,e,(e=>{t&&f(),o(e)}))}function I(e,t,o){!function(e,t,o){console.log("task when calling update task",t),e.get("0000",((s,l)=>{if(!s){let s=l.tasks.filter((e=>e.id!==t.id));return s.push(t),console.log("taskArr is, ",s),e.put({_id:"0000",_rev:l._rev,email:l.email,pwd:l.pwd,theme:l.theme,index:l.index,dailyLogs:l.dailyLogs,monthlyLogs:l.monthlyLogs,futureLogs:l.futureLogs,trackers:l.trackers,collections:l.collections,imageBlocks:l.imageBlocks,audioBlocks:l.audioBlocks,textBlocks:l.textBlocks,tasks:s,events:l.events,signifiers:l.signifiers},((e,t)=>{o(e||t)}))}o(s)}))}(m,e,(e=>{t&&f(),o(e)}))}const S=(e,t)=>{Array.isArray(t)?t.forEach((t=>S(e,t))):"TEMPLATE"===e.tagName?e.content.appendChild(t.nodeType?t:document.createTextNode(t)):e.appendChild(t.nodeType?t:document.createTextNode(t))},D=(e,t,...o)=>{const s=document.createElement(e);return Object.entries(t||{}).forEach((([e,t])=>{e.startsWith("on")&&e.toLocaleLowerCase()in window?s.addEventListener(e.toLowerCase().substring(2),t):s.setAttribute(e,t.toString())})),o.forEach((e=>{S(s,e)})),s};let E=D("template",null,D("link",{type:"text/css",rel:"stylesheet",href:"creator.css"}),D("div",{id:"editorIcons",class:"paragraphIcons"},D("img",{src:"./public/resources/plusIcon.png",class:"unfocusedIcons"}),D("img",{src:"./public/resources/sixDotIcon.png",class:"unfocusedIcons"})),D("div",{id:"textBlock",contentEditable:"true",onDrop:()=>!1,class:"unstylized",placeholder:'Type "/" to create an item: future log, collection, etc'}));class M extends HTMLElement{constructor(){super(),console.log(E),this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(E.content.cloneNode(!0))}connectedCallback(){let e=this.shadowRoot.getElementById("textBlock");e.onkeydown=t=>{if("Enter"===t.key){t.preventDefault();let o=e.innerHTML;"/futurelog"===o?alert("New Future Log will be created"):"/monthlylog"===o?alert("New Monthly Log will be created"):"/dailylog"===o?alert("New Daily Log will be created"):"/collection"===o?alert("New Collection will be created"):"/tracker"===o&&L("Practice Tracker",[],Me.id,!0,((e,t)=>{e?console.log(e):console.log(t)}))}}}}function F(e,t){let o=1,s=setInterval((()=>{let l=!1;o<=.1&&(clearInterval(s),e.style.display="none",l=!0),e.style.opacity=o,o-=.1*o,l&&t()}),10)}function C(e,t){let o=!1,s=.1;e.style.display="block";let l=setInterval((()=>{s>=1&&(clearInterval(l),o=!0),e.style.opacity=s,s+=.1*s,o&&t()}),10)}window.customElements.define("creator-block",M);const R={};let N="";R.setState=function(e,t){Ce(e),N=e,setTimeout((()=>{for(document.getElementById("trackerWrapper").childNodes.length>0&&document.getElementById("trackerWrapper").removeChild(document.getElementById("trackerWrapper").childNodes[0]);document.getElementById("contentWrapper").childNodes.length>0;)document.getElementById("contentWrapper").removeChild(document.getElementById("contentWrapper").childNodes[0]);document.querySelector("body").className="";let o=document.querySelector("body"),s=Ie.shadowRoot.querySelectorAll("button");F(o,(()=>{v((l=>{console.log(l),null===N||"#index"===N||""===N?Re(s):N.includes("#dailyLog")?_e(s,e):N.includes("#monthlyLog")?He(s,e):N.includes("#futureLog")&&Ne(s,e),t||history.pushState({page:Ee},"",De),C(o,(()=>{console.log("unfading the content")}))}))}))}),150)};let H=D("template",null,D("link",{type:"text/css",rel:"stylesheet",href:"dropdown.css"}),D("div",{id:"editorIcons",class:"paragraphIcons"},D("img",{src:"../public/resources/plusIcon.png",class:"unfocusedIcons"}),D("img",{src:"../public/resources/sixDotIcon.png",class:"unfocusedIcons"})),D("div",{id:"wrapper"},D("div",{id:"titleWrapper"},D("h1",{id:"title"}),D("button",{id:"arrow"},D("img",{src:"../public/resources/right-chevron.png"}))),D("div",{id:"contentWrapper"})));class _ extends HTMLElement{constructor(e,t,o=1){super(),this.currentHeight=5,this.item=t,this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(H.content.cloneNode(!0)),this.shadowRoot.getElementById("titleWrapper").class=o>1?"singleItemWrapper":"",this.shadowRoot.host.setAttribute("--level",o),this.shadowRoot.host.setAttribute("--tabspace",3),this.button=this.shadowRoot.getElementById("arrow"),this.wrapper=this.shadowRoot.getElementById("wrapper"),this.contentWrapper=this.shadowRoot.getElementById("contentWrapper"),this.header=this.shadowRoot.querySelector("h1"),this.title=e,this.titleWrapper=this.shadowRoot.querySelector("#titleWrapper")}connectedCallback(){this.removeAttribute("closed"),this.button.addEventListener("click",(()=>{this.toggleItems()})),this.header.addEventListener("click",(()=>{this.navigateToObject()}))}get title(){return this.header.innerText}set title(e){this.header.innerText=e}get closed(){return this.wrapper.hasAttribute("closed")}set closed(e){e?this.hide():this.display()}navigateToObject(){R.setState(`#${this.item.objectType}~${this.item.id}`,!1),Ie.open=!1}display(){this.wrapper.classList.toggle("closed",!0)}hide(){this.wrapper.classList.toggle("closed",!1)}toggleItems(){this.wrapper.classList.toggle("closed"),this.wrapper.classList.contains("closed")?this.display():this.hide()}}window.customElements.define("drop-down",_);let P=D("template",null,D("link",{type:"text/css",rel:"stylesheet",href:"generalSettingsPanel.css"}),D("div",{class:"profile"},"Profile placeholder"),D("button",{id:"logout"}," Logout "));class j extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(P.content.cloneNode(!0));let e=this.shadowRoot.querySelectorAll("input[type=radio]");for(let t of e)t.addEventListener("change",(()=>this.updateTheme(t.id)));this.logoutButton=this.shadowRoot.getElementById("logout")}connectedCallback(){this.logoutButton.onclick=()=>{(navigator.onLine||confirm("You're logging out while offline, all your local changes will be deleted if you continue!"))&&(f(),m.destroy(((e,t)=>{e?console.log(e):console.log(t)})),m.info(((e,t)=>{e?console.log(e):console.log(t)})),window.location.href="/login")}}}customElements.define("general-settings-panel",j);const $={darkmode:{"--border-color":"#292929","--content-foreground-color":"#D4D4D4","--content-background-color":"#2e3030","--tracker-foreground-color":"#FFFFFF","--tracker-background-color":"#1e2020","--tracker-border-color":"#404040","--navbar-foreground-color":"#FFFFFF","--navbar-background-color":"#1e2020","--icon-filter":"invert()"},lightmode:{"--border-color":"#F2F2F2","--content-foreground-color":"#000000","--content-background-color":"#FFFFFF","--tracker-foreground-color":"#FFFFFF","--tracker-border-color":"#48486f","--tracker-background-color":"#2B2D42","--navbar-foreground-color":"#FFFFFF","--navbar-background-color":"#F7F2EC","--icon-filter":""},highcontrast:{"--border-color":"#F2F2F2","--content-foreground-color":"#FFFFFF","--content-background-color":"#000000","--tracker-foreground-color":"#FFFFFF","--tracker-background-color":"#0000FF","--tracker-border-color":"#FFFFFF","--navbar-foreground-color":"#FFFFFF","--navbar-background-color":"#008F00","--icon-filter":"invert()"},theme4:{"--border-color":"#F2F2F2","--content-foreground-color":"#000000","--content-background-color":"#FFFFFF","--tracker-foreground-color":"#FFFFFF","--tracker-background-color":"#026670","--tracker-border-color":"#7671B6","--navbar-foreground-color":"#FEF9C7","--navbar-background-color":"#FCE181","--icon-filter":""},theme5:{"--border-color":"#8E8D8A","--content-foreground-color":"#000000","--content-background-color":"#EAE7DC","--tracker-foreground-color":"#FFFFFF","--tracker-background-color":"#48131A","--tracker-border-color":"#6F474E","--navbar-foreground-color":"#000000","--navbar-background-color":"#D8C3A5","--icon-filter":""},theme6:{"--border-color":"#34375c","--content-foreground-color":"#E3E3E8","--content-background-color":"#1A1A3D","--tracker-foreground-color":"#E3E3E8","--tracker-background-color":"#25274D","--tracker-border-color":"#464866","--navbar-foreground-color":"#000000","--navbar-background-color":"#25274D","--content-placeholder-color":"#505b84","--icon-filter":"invert()"}};let q=D("template",null,D("link",{type:"text/css",rel:"stylesheet",href:"themePanel.css"}),D("form",{id:"theme"},D("input",{type:"radio",name:"themeradio",id:"darkmode"}),D("label",{for:"darkmode"},"Cool Dark",D("br",null),D("img",{class:"themeImg",src:"../../public/resources/coolDark.png"})),D("br",null),D("input",{type:"radio",name:"themeradio",id:"lightmode"}),D("label",{for:"lightmode"},"Minimal Light",D("br",null),D("img",{class:"themeImg",src:"../../public/resources/minimalLight.png"})),D("br",null),D("input",{type:"radio",name:"themeradio",id:"highcontrast"}),D("label",{for:"highcontrast"},"High Contrast",D("br",null),D("img",{class:"themeImg",src:"../../public/resources/highContrast.png"})),D("br",null),D("input",{type:"radio",name:"themeradio",id:"theme4"}),D("label",{for:"theme4"},"Snazzy Light",D("br",null),D("img",{class:"themeImg",src:"../../public/resources/snazzyLight.png"})),D("br",null),D("input",{type:"radio",name:"themeradio",id:"theme5"}),D("label",{for:"theme5"},"Classy Light",D("br",null),D("img",{class:"themeImg",src:"../../public/resources/classyLight.png"})),D("br",null),D("input",{type:"radio",name:"themeradio",id:"theme6"}),D("label",{for:"theme6"},"Night Owl",D("br",null),D("img",{class:"themeImg",src:"../../public/resources/nightOwl.png"})),D("br",null)));class Y extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(q.content.cloneNode(!0)),this.themeRadios=this.shadowRoot.querySelectorAll("input[type=radio]")}connectedCallback(){for(let e of this.themeRadios)e.addEventListener("change",(()=>{var t,o,s;t=e.id,o=!0,s=t=>{console.log("here"),t?console.log(t):(console.log("here"),this.updateTheme(e.id))},function(e,t,o){console.log(t),e.get("0000",((s,l)=>{if(!s)return e.put({_id:"0000",_rev:l._rev,email:l.email,pwd:l.pwd,theme:t,index:l.index,dailyLogs:l.dailyLogs,monthlyLogs:l.monthlyLogs,futureLogs:l.futureLogs,collections:l.collections,trackers:l.trackers,imageBlocks:l.imageBlocks,audioBlocks:l.audioBlocks,textBlocks:l.textBlocks,tasks:l.tasks,events:l.events,signifiers:l.signifiers},((e,t)=>{e?o(e):(console.log(t),o(null))}));o(s)}))}(m,t,(e=>{o&&f(),s(e)}))}));v(((e,t)=>{e?(this.shadowRoot.getElementById(t.theme).toggleAttribute("checked",!0),this.updateTheme(t.theme)):console.log(e)}))}updateTheme(e){let t=document.documentElement;for(let o in $[e])null!==o&&t.style.setProperty(o,$[e][o])}}customElements.define("theme-panel",Y);let O=D("template",null,D("link",{type:"text/css",rel:"stylesheet",href:"settings.css"}),D("div",{class:"overlay"},D("div",{class:"menu"},D("div",{class:"sidebar"},D("slot",{name:"settings-tab"})),D("div",{class:"content"},D("div",{class:"header"},D("h1",null,"Settings"),D("button",{id:"close"},D("img",{id:"dismiss",src:"../../public/resources/xIcon.png"}))),D("div",{class:"options"},D("slot",{name:"settings-panel"}))))));class W extends HTMLElement{static get observedAttributes(){return["open"]}constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(O.content.cloneNode(!0)),this.shadowRoot.getElementById("close").addEventListener("click",(()=>{this.hide()})),this.tabSlot=this.shadowRoot.querySelector("slot[name=settings-tab]"),this.panelSlot=this.shadowRoot.querySelector("slot[name=settings-panel]"),this.changeTab=this.changeTab.bind(this),this.linkPanels=this.linkPanels.bind(this),this.tabSlot.addEventListener("slotchange",(()=>this.linkPanels)),this.panelSlot.addEventListener("slotchange",(()=>this.linkPanels)),this.headerTitle=this.shadowRoot.querySelector(".header h1")}connectedCallback(){this.innerHTML='\n\t<style>\n\t\tsettings-tab {\n\t\t\tcursor: pointer;\n\t\t}\n\t</style>\n    <settings-tab slot="settings-tab" title="Settings">\n        <img slot="icon" src="public/resources/generalSettingsIcon.png">\n    </settings-tab>\n    <settings-panel slot="settings-panel">\n        <general-settings-panel>\n    </settings-panel>\n\n    <settings-tab slot="settings-tab" title="Theme">\n        <img slot="icon" src="public/resources/palette.png">\n    </settings-tab>\n    <settings-panel slot="settings-panel">\n        <theme-panel></theme-panel>\n    </settings-panel>\n',this.classList.toggle("open",!1),this.setAttribute("aria-hidden",!0),this.style.display="none",this.removeAttribute("open"),Promise.all([customElements.whenDefined("settings-tab"),customElements.whenDefined("settings-panel")]).then((()=>this.linkPanels())),this.addEventListener("click",(e=>{"tab"===e.target.getAttribute("role")&&this.changeTab(e.target)}))}tabs(){return this.querySelectorAll("settings-tab")}panels(){return this.querySelectorAll("settings-panel")}linkPanels(){let e=this.tabs();if(0===e.length)return;let t=null;for(let o of e){let e=o.nextElementSibling;o.setAttribute("aria-controls",e.id),e.setAttribute("aria-labelledby",o.id),null===t&&o.selected&&(t=o)}null===t&&(t=e.item(0)),this.changeTab(t)}changeTab(e){let t=Array.from(this.tabs()),o=Array.from(this.panels());t.forEach((e=>{e.selected=!1})),o.forEach((e=>{e.hidden=!0}));let s=e.getAttribute("aria-controls"),l=this.querySelector(`#${s}`);l||console.log("panel not found"),this.headerTitle.innerText=e.getAttribute("title"),e.selected=!0,l.hidden=!1,e.focus()}attributeChangedCallback(e,t,o){t!==o&&(this[e]=this.hasAttribute(e))}get open(){return this.hasAttribute("open")}set open(e){this.classList.toggle("open",e),this.setAttribute("aria-hidden",!e),e?(this.setAttribute("open","true"),C(this,(()=>{this.focus()}))):F(this,(()=>{this.removeAttribute("open")}))}toggle(){this.open=!this.open}show(){this.open=!0}hide(){this.open=!1}}customElements.define("settings-menu",W);let J=0,U=document.createElement("template");U.innerHTML='\n<style>\n    :host {\n        padding: 10px;\n    }\n\n    ::slotted(img) {\n        pointer-events: none;\n        width: 32px;\n        height: 32px;\n        opacity: 50%;\n        filter: var(--icon-filter);\n    }\n\n    :host(:hover) ::slotted(img) {\n        opacity: 100%;\n        transition: opacity 150ms;\n    }\n</style>\n\n<slot name="icon"></slot>\n';class z extends HTMLElement{static get observedAttributes(){return["selected"]}constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(U.content.cloneNode(!0))}connectedCallback(){this.setAttribute("role","tab"),this.id||(this.id=`settings-tab-generated-${J}`,J+=1),this.setAttribute("aria-selected","false")}attributeChangedCallback(){const e=this.hasAttribute("selected");this.setAttribute("aria-selected",e)}set selected(e){Boolean(e)?this.setAttribute("selected",""):this.removeAttribute("selected")}get selected(){return this.hasAttribute("selected")}}customElements.define("settings-tab",z);let X=0;class G extends HTMLElement{connectedCallback(){this.setAttribute("role","tabpanel"),this.id||(this.id=`settings-panel-generated-${X}`,X+=1)}}customElements.define("settings-panel",G);let Q=D("template",null,D("link",{type:"text/css",rel:"stylesheet",href:"navbar.css"}),D("nav",{class:"nav-bar"},D("button",{id:"home"},"  ",D("img",{src:"../public/resources/home_icon.png"})),D("button",{id:"target"},D("img",{src:"../public/resources/target_icon.png"})),D("button",{id:"single"},D("img",{src:"../public/resources/left.png"})),D("button",{id:"double"},D("img",{src:"../public/resources/double_icon.png"})),D("div",{id:"bottom"},D("button",{id:"user"},"  ",D("img",{src:"../public/resources/user.png"})))),D("nav",{class:"navigation"},D("div",{id:"menu",class:"closed"},D("button",{id:"homeMenu"},"  ",D("img",{src:"../public/resources/home_icon.png"})),D("button",{id:"singleMenu"},D("img",{src:"../public/resources/left.png"})),D("button",{id:"doubleMenu"},D("img",{src:"../public/resources/double_icon.png"})),D("button",{id:"userMenu"},"  ",D("img",{src:"../public/resources/user.png"})))));class K extends HTMLElement{static get observedAttributes(){return["open"]}constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(Q.content.cloneNode(!0)),this.home=this.shadowRoot.querySelectorAll("button")[0],this.target=this.shadowRoot.querySelectorAll("button")[1],this.single=this.shadowRoot.querySelectorAll("button")[2],this.double=this.shadowRoot.querySelectorAll("button")[3],this.user=this.shadowRoot.querySelectorAll("button")[4],this.menu=this.shadowRoot.querySelector("#menu"),this.homeMenu=this.shadowRoot.querySelector("#homeMenu"),this.singleMenu=this.shadowRoot.querySelector("#singleMenu"),this.doubleMenu=this.shadowRoot.querySelector("#doubleMenu"),this.userMenu=this.shadowRoot.querySelector("#userMenu")}connectedCallback(){this.home.addEventListener("click",(()=>{this.goHome()})),this.target.addEventListener("click",(()=>{this.toggleTracker()})),this.single.addEventListener("click",(()=>{this.goBack()})),this.double.addEventListener("click",(()=>{this.goFarBack()})),this.user.addEventListener("click",(()=>{document.querySelector("settings-menu").toggle()})),this.homeMenu.addEventListener("click",(()=>{this.goHome(),this.open=!1})),this.singleMenu.addEventListener("click",(()=>{this.goBack(),this.open=!1})),this.doubleMenu.addEventListener("click",(()=>{this.goFarBack(),this.open=!1})),this.userMenu.addEventListener("click",(()=>{let e=document.querySelector("settings-menu");typeof e===W&&e.toggle()}))}attributeChangedCallback(e,t,o){t!==o&&(this[e]=o)}goHome(){null!==document.location.hash&&"#index"!==document.location.hash&&""!==document.location.hash&&R.setState("",!1)}goBack(){let e=document.location.hash.includes("#dailyLog")?"monthlyLog":"futureLog";R.setState(`#${e}~${Me.parent}`,!1)}goFarBack(){let e=document.location.hash.includes("#dailyLog")?"futureLog":"index";localStorage.readUser(((t,o)=>{if(null===t){let t=[];Array.prototype.push.apply(t,o.dailyLogs),Array.prototype.push.apply(t,o.monthlyLogs),Array.prototype.push.apply(t,o.futureLogs),Array.prototype.push.apply(t,o.collections);let s=t.filter((e=>e.id===Me.parent))[0];R.setState(`#${e}~${s.parent}`,!1)}else console.log(t)}))}toggleTracker(){document.querySelector("tracker-menu").toggle()}toggle(){this.open=!this.open}get open(){return this.hasAttribute("open")}set open(e){this.menu.classList.toggle("open",e),this.menu.classList.toggle("closed",!e),this.menu.setAttribute("aria-hidden",!e),e?(this.setAttribute("open","true"),this.focus(),Se.menuToggle.checked=!0):(this.removeAttribute("open"),Se.menuToggle.checked=!1)}}customElements.define("nav-bar",K);let V=D("template",null,D("link",{type:"text/css",rel:"stylesheet",href:"header.css"}),D("div",{id:"container"},D("div",{id:"menuToggle"},D("input",{type:"checkbox"}),D("span",null),D("span",null),D("span",null)),D("span",{class:"header"},D("button",{class:"imgbutton",id:"header_back"},D("img",{src:"../public/resources/left-chevron.png"})),D("h1",{id:"title_page"},"Template Page Title"),D("button",{class:"imgbutton",id:"header_forward"},D("img",{src:"../public/resources/right-chevron.png"}))),D("button",{class:"imgbutton plus"},D("img",{src:"../public/resources/plusIcon.png"})),D("span",{class:"search_bar"},D("input",{type:"text",placeholder:"Search"}),D("img",{src:"../public/resources/search_icon.png"}))));class Z extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(V.content.cloneNode(!0)),this.h1=this.shadowRoot.getElementById("title_page"),this.createFutureLog=this.createFutureLog.bind(this),this.futureLogButton=this.shadowRoot.querySelector(".plus"),this.futureLogButton.addEventListener("click",(()=>{this.createFutureLog()})),this.imgbuttons=this.shadowRoot.querySelectorAll(".imgbutton"),this.menuToggle=this.shadowRoot.querySelector("#menuToggle input")}connectedCallback(){this.menuToggle.addEventListener("change",(()=>{Ie.toggle()}))}makeEditabe(){this.h1.contentEditable=!0}makeUneditable(){this.h1.contentEditable=!1}set title(e){this.shadowRoot.getElementById("title_page").innerHTML=e}get title(){return this.h1.innerText}createFutureLog(){var e,o,s;e=new Date(2021,5,22),o=new Date(2021,8,23),s=(e,t)=>{e?console.log(e):v(((e,o)=>{e?console.log(e):o.ok&&console.log(t)}))},function(e,o,s,l,i,c,d){e.get("0000").then((n=>{let a=t(),d=[];for(Array.prototype.push.apply(d,n.dailyLogs),Array.prototype.push.apply(d,n.monthlyLogs),Array.prototype.push.apply(d,n.futureLogs),Array.prototype.push.apply(d,n.collections),Array.prototype.push.apply(d,n.trackers),Array.prototype.push.apply(d,n.textBlocks),Array.prototype.push.apply(d,n.tasks),Array.prototype.push.apply(d,n.events),Array.prototype.push.apply(d,n.signifiers),Array.prototype.push.apply(d,n.imageBlocks),Array.prototype.push.apply(d,n.audioBlocks);d.filter((e=>e.id===a)).length>0;)a=t();return r={id:a,objectType:"futureLog",startDate:o,endDate:s,months:l,content:i,trackers:c},n.futureLogs.push(r),n.index.contents.push(r.id),e.put({_id:"0000",_rev:n._rev,email:n.email,pwd:n.pwd,theme:n.theme,index:n.index,dailyLogs:n.dailyLogs,monthlyLogs:n.monthlyLogs,futureLogs:n.futureLogs,collections:n.collections,trackers:n.trackers,imageBlocks:n.imageBlocks,audioBlocks:n.audioBlocks,textBlocks:n.textBlocks,tasks:n.tasks,events:n.events,signifiers:n.signifiers})})).then((t=>{t.ok&&a(new Date(r.startDate.getTime()),new Date(r.endDate.getTime()),r,(t=>{e.get("0000").then((o=>{r.months=t,o.futureLogs[o.futureLogs.length-1]=r,e.put({_id:"0000",_rev:o._rev,email:o.email,pwd:o.pwd,theme:o.theme,index:o.index,dailyLogs:o.dailyLogs,monthlyLogs:o.monthlyLogs,futureLogs:o.futureLogs,collections:o.collections,trackers:o.trackers,imageBlocks:o.imageBlocks,audioBlocks:o.audioBlocks,textBlocks:o.textBlocks,tasks:o.tasks,events:o.events,signifiers:o.signifiers},((e,t)=>{n=!1,e?d(e,null):t.ok&&d(null,r)}))}))}))})).catch((e=>{d(e,null)}))}(m,e,o,[],[],[],((e,t)=>{f(),s(e,t)}))}}window.customElements.define("page-header",Z);const ee="attachShadow"in Element.prototype&&"getRootNode"in Element.prototype,te=Boolean(ee&&document.createElement("div").attachShadow({mode:"open"}).getSelection),oe=window.ShadyDOM&&window.ShadyDOM.inUse,se=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,le=!ee||oe||!te&&!se,ne=/^(area|base|br|col|command|embed|hr|img|input|keygen|link|meta|param|script|source|style|template|track|wbr)$/,ie="-shadow-selectionchange",re=[Node.ELEMENT_NODE,Node.TEXT_NODE,Node.DOCUMENT_FRAGMENT_NODE];function ae(e,t,o){const s=t.childNodes||t.children;if(!s)return t;for(let t=0;t<s.length;++t){const n=s[o?t:s.length-1-t];if(l=n,re.includes(l.nodeType)&&e.containsNode(n,!0)){if(e.containsNode(n,!1))return n;if(!ne.exec(n.localName||""))return ae(e,n,o)}}var l;return t}let ce={node:null,offset:-1};function de(e,t,o){const s=t;for(;(t=he(t,o))&&t.contains(s););return!!t&&t instanceof Element&&e.containsNode(t,!0)}function he(e,t){if(!t)return e.previousSibling||e.parentNode||null;for(;e;){if(e.nextSibling)return e.nextSibling;e=e.parentNode}return null}!function(){if(te||le)return document.addEventListener("selectionchange",(e=>{document.dispatchEvent(new CustomEvent(ie))})),()=>{};let e=!1;document.addEventListener("selectionchange",(t=>{if(e)return;e=!0;const o=window.getSelection();if("Caret"===o.type){const e=function(e,t){const o=[],s=e=>{for(let t=0;t<e.length;++t)e[t].shadowRoot&&o.push(e[t].shadowRoot)};for(t.shadowRoot&&o.push(t.shadowRoot),s(t.childNodes);o.length;){const t=o.shift();for(let o=0;o<t.childNodes.length;++o)if(e.containsNode(t.childNodes[o],!0))return t;s(t.querySelectorAll("*"))}return null}(o,o.anchorNode);if(e instanceof window.ShadowRoot){const t=pe(e);if(t){const e=t.startContainer,o=t.startOffset;ce={node:e,offset:o}}}}document.dispatchEvent(new CustomEvent("-shadow-selectionchange")),window.requestAnimationFrame((()=>{e=!1}))}))}();const ue=new Map;function pe(e){if(le){const t=document.getSelection();return t.containsNode(e,!0)?t.getRangeAt(0):null}if(te){const t=e.getSelection();return t.rangeCount?t.getRangeAt(0):null}const t=ue.get(e);if(t)return t;const o=function(e){const t=window.getSelection();if("None"===t.type)return{range:null,type:"none"};if("Caret"!==t.type&&"Range"!==t.type)throw new TypeError("unexpected type: "+t.type);const o=ae(t,e,!0);if(o===e)return{range:null,mode:"none"};const s=document.createRange();let l,n=null;if("Range"===t.type&&(n=ae(t,e,!1),l=function(e,t,o){if("Range"!==e.type)return;const s=()=>e.toString().length,l=s();let n;return e.modify("extend","forward","character"),n=s(),n>l||de(e,o,!0)?(e.modify("extend","backward","character"),!0):n<l||!e.containsNode(t)?(e.modify("extend","backward","character"),!1):(e.modify("extend","backward","character"),n=s(),n>l||de(e,t,!1)?(e.modify("extend","forward","character"),!1):n<l||!e.containsNode(o)?(e.modify("extend","forward","character"),!0):void 0)}(t,o,n),void 0===l))return s.setStart(o,0),s.setEnd(n,n.length),{range:s,mode:"all"};const i=t.toString().length;let r=0,a=0;if(null===n);else if(n.nodeType===Node.TEXT_NODE){const e=n.textContent,o=n.nextSibling;for(let o=e.length-1;o>=0;--o)if(n.splitText(o),t.toString().length!==i){a=o+1;break}for(n.insertData(n.length,e.substr(n.length));n.nextSibling!==o;)n.nextSibling.remove()}if(o.nodeType===Node.TEXT_NODE){o!==n&&(o.appendData("?"),t.collapseToStart(),t.modify("extend","right","character"));const e=o.textContent,s=o.nextSibling;for(let s=o===n?a:e.length-1;s>=0;--s)if(o.splitText(s),""===t.toString()){r=s;break}for(o.insertData(o.length,e.substr(o.length));o.nextSibling!==s;)o.nextSibling.remove();o!==n&&o.deleteData(o.length-1,1),null===n&&(n=o,a=r)}else null===n&&(n=o);return 1===i&&ce&&ce.node===o&&ce.offset>r&&l&&(l=!1),!0===l?(t.collapse(o,r),t.extend(n,a)):!1===l?(t.collapse(n,a),t.extend(o,r)):t.setPosition(o,r),s.setStart(o,r),s.setEnd(n,a),{range:s,mode:"normal"}}(e);return ue.set(e,o.range),window.setTimeout((()=>{ue.delete(e)}),0),o.range}const ge=["Control","Alt","CapsLock","Escape","PageUp","PageDown","End","Home","PrintScreen","Insert","Delete","Backspace","Tab","Enter","Meta","ArrowTop","ArrowBottom","ArrowRight","ArrowLeft","Shift"," "];function ye(e,t){return"3"===e||"5"===e||"8"===e||"10"===e?30:"1"===e&&function(e){return e%100==0?e%400==0:e%4==0}(t)?29:"1"===e?28:31}function me(e,t,o){for(let s=0;s<t.length;s++)56517===t.charCodeAt(s)&&(o?e.dateSetter=!0:(e.hashPressed=!0,e.atPressed=!1)),56688===t.charCodeAt(s)&&(o?e.timeSetter=!0:(e.atPressed=!0,e.hashPressed=!1))}let fe=D("template",null,D("link",{type:"text/css",rel:"stylesheet",href:"./block.css"}),D("div",{id:"editorIcons",class:"paragraphIcons"},D("img",{src:"../public/resources/plusIcon.png",class:"unfocusedIcons"}),D("img",{src:"../public/resources/sixDotIcon.png",class:"unfocusedIcons"}),D("div",{id:"signifier"})),D("div",{id:"checkerContainer",checked:""},D("div",{id:"taskChecker"})),D("div",{id:"textBlock",contentEditable:"true",onDrop:()=>!1,placeholder:'Type "/" to create a block'}));class ke extends HTMLElement{constructor(e,t,o,s){super(),this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(fe.content.cloneNode(!0)),this.shadowRoot.adoptedStyleSheets=[],this.root=this.shadowRoot,this.characterIndex=0,this.kind="paragraph",this.initialHeight=3,this.item=t,this.controller=e,this.shadowRoot.getElementById("textBlock").classList.add("unstylized"),this.currentBlock=null,this.checkBox=this.shadowRoot.getElementById("checkerContainer"),this.checkBox.style.display="none",this.currentPointerSpot=0,this.editorIcons=this.shadowRoot.getElementById("editorIcons"),this.currentPointerHeight=2,this.controller.creatingFromBullet.isTrue&&("note"===this.controller.creatingFromBullet.kind?this.setupNote():"event"===this.controller.creatingFromBullet.kind?this.setupEvent():this.setupTask()),this.tabLevel=e.currentTabLevel,this.atPressed=!1,this.hashPressed=!1,this.timeSetter=!1,this.dateSetter=!1,this.eventDelete=!0,this.signifier=o,this.signifierIcon=this.shadowRoot.getElementById("signifier"),this.signifierIcon.innerHTML=this.signifier.symbol,this.setupTabLevel(),setTimeout((()=>{s(!0)}),30)}setCurrentSpot(){let e=this.shadowRoot.getElementById("textBlock"),t=pe(this.shadowRoot);if(null===t){let e=20*this.tabLevel;this.currentPointerSpot=e+10,this.currentPointerHeight=this.initialHeight}else{let o=20*this.tabLevel,s=t.cloneRange();s.selectNodeContents(e),s.setEnd(t.endContainer,t.endOffset),this.atPressed=!1,this.hashPressed=!1,me(this,e.innerText.slice(0,t.endOffset),!1),this.characterIndex=t.endOffset,this.currentPointerSpot=void 0===t.getClientRects()[0]?o+10:t.getClientRects()[0].x,this.currentPointerHeight=void 0===t.getClientRects()[0]?this.initialHeight:t.getClientRects()[0].y-e.getBoundingClientRect().top}}moveToSpot(e,t){let o=e,s=this.shadowRoot.getElementById("textBlock");if(s.childNodes.length>0){this.controller.resetPosition||(o=this.currentPointerSpot),s.focus();let e=pe(this.shadowRoot);s.blur(),console.log(o),console.log(o),setTimeout((()=>{let l=0;t&&(l=s.textContent.length),e.setStart(s.childNodes[0],l);let n=e.getClientRects()[0].x,i=l,r=0;for(o=Math.floor(o);r<1e3;){l=t?l>0?l-1:l:l<s.textContent.length?l+1:l,e.setStart(s.childNodes[0],l),e.collapse(!0);let a=e.getClientRects()[0].x;if(Math.abs(Math.floor(n)-o)<=Math.abs(Math.floor(a)-o)){e.setStart(s.childNodes[0],i);break}n=a,i=l,r+=1}e.collapse(!0),window.getSelection().removeAllRanges(),window.getSelection().addRange(e),s.focus()}),.01)}else s.focus()}setupHeader1(){let e=this.shadowRoot.getElementById("textBlock");for(;this.editorIcons.classList.length>0;)this.editorIcons.classList.remove(this.editorIcons.classList[0]);for(;e.classList.length>0;)e.classList.remove(e.classList[0]);for(;this.classList.length>0;)this.classList.remove(this.classList[0]);this.controller.creatingFromBullet={isTrue:!1,kind:""},this.kind="h1",this.initialHeight=0,e.setAttribute("placeholder","Header 1"),e.classList.add("header1"),this.editorIcons.classList.add("header1Icons"),e.innerHTML="",this.checkBox.style.display="none"}setupHeader2(){let e=this.shadowRoot.getElementById("textBlock");for(;this.editorIcons.classList.length>0;)this.editorIcons.classList.remove(this.editorIcons.classList[0]);for(;e.classList.length>0;)e.classList.remove(e.classList[0]);for(;this.classList.length>0;)this.classList.remove(this.classList[0]);this.controller.creatingFromBullet={isTrue:!1,kind:""},this.kind="h2",this.initialHeight=0,e.setAttribute("placeholder","Header 2"),e.classList.add("header2"),this.editorIcons.classList.add("header2Icons"),e.innerHTML="",this.checkBox.style.display="none"}setupHeader3(){let e=this.shadowRoot.getElementById("textBlock");for(;this.editorIcons.classList.length>0;)this.editorIcons.classList.remove(this.editorIcons.classList[0]);for(;e.classList.length>0;)e.classList.remove(e.classList[0]);for(;this.classList.length>0;)this.classList.remove(this.classList[0]);this.controller.creatingFromBullet={isTrue:!1,kind:""},this.kind="h3",this.initialHeight=0,e.setAttribute("placeholder","Header 3"),e.classList.add("header3"),this.editorIcons.classList.add("header3Icons"),e.innerHTML="",this.checkBox.style.display="none"}setupNote(){let e=this.shadowRoot.getElementById("textBlock");for(;this.editorIcons.classList.length>0;)this.editorIcons.classList.remove(this.editorIcons.classList[0]);for(;e.classList.length>0;)e.classList.remove(e.classList[0]);for(;this.classList.length>0;)this.classList.remove(this.classList[0]);this.kind="note",this.controller.creatingFromBullet={isTrue:!0,kind:this.kind},this.initialHeight=3,e.setAttribute("placeholder","Note"),this.classList.add("noteContainer"),this.editorIcons.classList.add("noteIcons"),e.classList.add("note"),e.innerHTML="",this.checkBox.style.display="none"}setupEvent(){let e=this.shadowRoot.getElementById("textBlock");for(;this.editorIcons.classList.length>0;)this.editorIcons.classList.remove(this.editorIcons.classList[0]);for(;e.classList.length>0;)e.classList.remove(e.classList[0]);for(;this.classList.length>0;)this.classList.remove(this.classList[0]);this.kind="event",this.controller.creatingFromBullet={isTrue:!0,kind:this.kind},this.initialHeight=3,e.setAttribute("placeholder","Event:");let t="";this.timeSetter?this.dateSetter||(t=`${t} use # for weekdays or dates MM/DD/YY`):(t=`${t} use @ for time HH:MM`,this.dateSetter||(t=`${t} and # for weekdays or dates MM/DD/YY`)),e.setAttribute("dateFiller",t),this.classList.add("eventContainer"),this.editorIcons.classList.add("noteIcons"),e.classList.add("note"),e.classList.add("eventNodateFocused"),e.innerHTML="",this.checkBox.style.display="none"}setupTask(){let e=this.shadowRoot.getElementById("textBlock");for(;this.editorIcons.classList.length>0;)this.editorIcons.classList.remove(this.editorIcons.classList[0]);for(;e.classList.length>0;)e.classList.remove(e.classList[0]);for(;this.classList.length>0;)this.classList.remove(this.classList[0]);this.kind="task",this.controller.creatingFromBullet={isTrue:!0,kind:this.kind},this.initialHeight=3,e.classList.add("task"),e.setAttribute("placeholder","Task"),e.innerHTML="",this.editorIcons.classList.add("paragraphIcons"),this.checkBox.style.display="inline"}removeStyles(){let e=this.shadowRoot.getElementById("textBlock");for(;this.editorIcons.classList.length>0;)this.editorIcons.classList.remove(this.editorIcons.classList[0]);for(;e.classList.length>0;)e.classList.remove(e.classList[0]);for(;this.classList.length>0;)this.classList.remove(this.classList[0]);this.kind="paragraph",this.initialHeight=3,e.classList.add("unstylized"),e.setAttribute("placeholder",'Type "/" to create a block'),e.innerHTML="",this.editorIcons.classList.add("paragraphIcons"),this.controller.creatingFromBullet={isTrue:!1,kind:""},this.checkBox.style.display="none"}setupTabLevel(){this.style.position="relative";let e=20*this.tabLevel;this.style.left=e+"px",this.controller.currentTabLevel=this.tabLevel,this.setCurrentSpot()}setupSignifier(e){this.signifier=e,this.signifierIcon.innerHTML=e.symbol}connectedCallback(){let e=this.shadowRoot.getElementById("textBlock");e.focus(),document.addEventListener(ie,(()=>{this.controller.blockArray[this.controller.currentBlockIndex].setCurrentSpot()})),this.checkBox.onclick=t=>{"checked"===this.checkBox.getAttribute("checked")?(this.checkBox.setAttribute("checked",""),e.classList.remove("crossed"),setTimeout((()=>{v(((e,t)=>{if(null===e){let e=t.tasks.filter((e=>e.id===this.item.objectReference))[0];e.complete=0,I(e,!0,((e,t)=>{console.log(e),console.log(t)}))}}))}),10)):(this.checkBox.setAttribute("checked","checked"),e.classList.add("crossed"),setTimeout((()=>{v(((e,t)=>{if(null===e){let e=t.tasks.filter((e=>e.id===this.item.objectReference))[0];console.log(e),e.complete=1,I(e,!0,((e,t)=>{console.log(e),console.log(t)}))}else console.log(e)}))}),10)),t.preventDefault()},e.onpaste=e=>{let t=e.clipboardData.getData("text/html")||e.clipboardData.getData("text/plain");t=t.replace(/<(?!(\/\s*)?(a|b|i|em|s|strong|u)[>,\s])([^>])*>/g,""),document.execCommand("insertText",!1,t),e.preventDefault()},e.onblur=()=>{e.classList.remove("eventNodateFocused");for(let e=0;e<this.editorIcons.childNodes.length-1;e++)this.editorIcons.childNodes[e].classList.remove("focusedIcons"),this.editorIcons.childNodes[e].classList.add("unfocusedIcons");let o=null;var s,l,n;"event"===this.kind&&(o=function(e,t){let o=null,s=e.shadowRoot.querySelector("#textBlock");if(e.dateSetter&&t){let l=1;for(let e=0;e<s.textContent.length;e++)if(56517===s.textContent.charCodeAt(e)){l=e+1;break}let n=s.textContent.length;if(e.dateSetter){let e=0;for(let t=0;t<s.textContent.length;t++)if(56688===s.textContent.charCodeAt(t)){e=t;break}e>=n&&(n=e)}let i=s.textContent.substring(l,n);i=i.replaceAll(" ","");let r=!1,a=["today","tomorrow","monday","tuesday","wednesday","thursday","friday","saturday","sunday"];a.includes(i.toLowerCase())?r=!0:(r=!0,(i.length>10||i.length<10||i.charAt(0).match(/[^01]/g)||"1"===i.charAt(0)&&i.charAt(1).match(/[^01]/g)||i.charAt(1).match(/[^0123456789]/g)||"/"!==i.charAt(2)||"/"!==i.charAt(5)||i.charAt(6).match(/[^0123456789]/g)||i.charAt(7).match(/[^0123456789]/g)||i.charAt(8).match(/[^0123456789]/g)||i.charAt(9).match(/[^0123456789]/g)||"0"===i.charAt(0)&&"2"===i.charAt(1)&&i.charAt(3).match(/[^012]/g)||i.charAt(3).match(/[^0123]/g)||i.charAt(4).match(/[^0123456789]/g)||ye("28"===(i.substring(0,2),i.substring(6))||"29"===ye(i.substring(0,2),i.substring(6)))&&i.charAt(3).match(/[^012]/g)||"31"===ye(i.substring(0,2),i.substring(6))&&"3"===i.charAt(3)&&i.charAt(4).match(/[^01]/g)||"30"===ye(i.substring(0,2),i.substring(6))&&"3"===i.charAt(3)&&i.charAt(4).match(/[^0]/g)||"28"===ye(i.substring(0,2),i.substring(6))&&"2"===i.charAt(3)&&i.charAt(4).match(/[^012345678]/g))&&(r=!1)),!r&&t?(i=`${s.textContent.substring(0,l-2)}${s.textContent.substring(n+1)}`,console.log("\n\n\n\n\n\n\n\n\n"),s.innerHTML=i,e.timeSetter=!1,e.atPressed=!1):a.includes(i.toLowerCase())?"today"===i.toLowerCase()?o=new Date:"tomorrow"===i.toLowerCase()?(o=new Date,o.setDate(o.getDate()+1)):o=function(e,t=!0,o=new Date){const s=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].indexOf(e.toLowerCase());if(!(s<0))return o.setHours(0,0,0,0),o.setDate((o.getDate()+Number(Boolean(t))+(s+7-o.getDay()-Number(Boolean(t))))%7),o}(i):o=new Date(i)}if(e.timeSetter&&t){let l=1;for(let e=0;e<s.textContent.length;e++)if(56688===s.textContent.charCodeAt(e)){l=e+1;break}let n=s.textContent.length;if(e.dateSetter){let e=0;for(let t=0;t<s.textContent.length;t++)if(56517===s.textContent.charCodeAt(t)){e=t;break}e>=n&&(n=e)}let i=s.textContent.substring(l,n);i=i.replaceAll(" ",""),console.log(i);let r=!0;(5!==i.length||i.charAt(0).match(/[^012]/g)||"2"===i.charAt(0)&&i.charAt(1).match(/[^0123]/g)||i.charAt(1).match(/[^0123456789]/g)||":"!==i.charAt(2)||i.charAt(3).match(/[^012345]/g)||i.charAt(4).match(/[^0123456789]/g))&&(r=!1),!r&&t?(i=`${s.textContent.substring(0,l-2)}${s.textContent.substring(n+1)}`,s.innerHTML=i,e.timeSetter=!1,e.atPressed=!1):(null===o&&(o=new Date),o.setHours(i.substring(0,2),i.substring(3)))}return o}(this,this.eventDelete),console.log(o)),this.eventDelete||(this.eventDelete=!0),null!==this.item?""===e.textContent?(console.log("goodbye my very old friend "+e.textContent),s=this.item,l=!0,n=e=>{console.log(e)},function(e,t,o){console.log("delete textblock is being deleted"),e.get("0000",((s,l)=>{if(s)o(s);else{const s=l.textBlocks.filter((e=>e.id===t));let n=null;console.log("textblockArr is ",s),s.length>0&&(n=s[0],"task"===n.kind?x(n.objectReference,!1,(s=>{s?o(s):g(e,n,t,o)})):"event"===n.kind?(console.log("delteeevntbyID"),B(n.objectReference,!1,(s=>{s?(console.log(s),o(s)):g(e,n,t,o)}))):g(e,n,t,o))}})).then((e=>{console.log(e),o(null)}))}(m,s.id,(e=>{l&&f(),n(e)}))):(console.log("hello my very old friend "+e.textContent),this.item.kind=this.kind,this.item.text=e.textContent,setTimeout((()=>{!function(e,t,o,s){!function(e,t,o,s){console.log(t),e.get("0000",((l,n)=>{if(l)s(l);else{console.log(t);let l=n.textBlocks,i={};for(let e=0;e<l.length;e++)l[e].id===t.id&&(i=l[e],l[e]=t);if("task"===t.kind)if("event"===i.kind){let o=[];Array.prototype.push.apply(o,n.events),w(o.filter((e=>e.id===t.objectReference))[0],!1,(o=>{o?console.log(o):b(t.id,t.text,0,t.signifier,!1,((o,n)=>{o?(console.log(o),s(o)):(t.objectReference=n.id,y(e,l,(e=>{e&&(console.log(e),s(e))})))}))}))}else if("task"===i.kind){let o=n.tasks.filter((e=>e.id===t.objectReference))[0];o.text=t.text,console.log("task before updating it is ",o),I(o,!1,(t=>{t?(console.log(t),s(t)):(console.log("textBlockArr before updateBlock @65 is, ",l),y(e,l,(e=>{e&&(console.log(e),s(e))})))}))}else"task"!==i.kind&&b(t.id,t.text,0,t.signifier,!1,((o,n)=>{o?(console.log(o),s(o)):(t.objectReference=n.id,y(e,l,(e=>{e&&(console.log(e),s(e))})))}));else if("task"!==t.kind&&"task"===i.kind){let o=[];Array.prototype.push.apply(o,n.tasks),A(o.filter((e=>e.id===i.objectReference))[0],!1,(o=>{o?(console.log(o),s(o)):(t.objectReference=null,y(e,l,(e=>{e&&(console.log(e),s(e))})))}))}else if("event"!==t.kind&&"event"===i.kind){let o=[];Array.prototype.push.apply(o,n.events),w(o.filter((e=>e.id===t.objectReference))[0],!1,(o=>{o?(console.log(o),s(o)):(t.objectReference=null,y(e,l,(e=>{e&&(console.log(e),s(e))})))}))}else if("event"===t.kind)if("event"===i.kind){let i=[];Array.prototype.push.apply(i,n.events);let r=i.filter((e=>e.id===t.objectReference))[0];console.log("event is ",n),r.title=t.text,r.date=o,T(r,!1,(t=>{t?(console.log(t),s(t)):y(e,l,(e=>{e&&(console.log(e),s(e))}))}))}else if("task"===i.kind){let i=[];Array.prototype.push.apply(i,n.tasks),A(i.filter((e=>e.id===t.objectReference))[0],!1,(n=>{n?console.log(n):k(t.text,t.id,o,t.signifier,!1,((o,n)=>{o?(console.log(o),s(o)):(t.objectReference=n.id,y(e,l,(e=>{e&&(console.log(e),s(e))})))}))}))}else"event"!==i.kind&&k(t.text,t.id,o,t.signifier,!1,((o,n)=>{o?(console.log(o),s(o)):(t.objectReference=n.id,y(e,l,(e=>{e&&(console.log(e),s(e))})))}))}}))}(m,e,t,(e=>{o&&f(),s(e)}))}(this.item,o,!0,(e=>{console.log(e)}))}),150)):""!==e.textContent&&function(e,o,s,l,n,i,r,a,c,h,u){!function(e,o,s,l,n,i,r,a,c,h,u){e.get("0000",((p,g)=>{if(p)u(p,null);else{let p=t(),y=[];for(Array.prototype.push.apply(y,g.dailyLogs),Array.prototype.push.apply(y,g.monthlyLogs),Array.prototype.push.apply(y,g.futureLogs),Array.prototype.push.apply(y,g.collections),Array.prototype.push.apply(y,g.trackers),Array.prototype.push.apply(y,g.textBlocks),Array.prototype.push.apply(y,g.tasks),Array.prototype.push.apply(y,g.events),Array.prototype.push.apply(y,g.signifiers),Array.prototype.push.apply(y,g.imageBlocks),Array.prototype.push.apply(y,g.audioBlocks);y.filter((e=>e.id===p)).length>0;)p=t();if(d={id:p,objectType:"textBlock",tabLevel:i,parent:o,kind:r,objectReference:a,text:n,signifier:c},"task"!==r&&"event"!==r){let t=[];Array.prototype.push.apply(t,g.dailyLogs),Array.prototype.push.apply(t,g.monthlyLogs),Array.prototype.push.apply(t,g.trackers),Array.prototype.push.apply(t,g.collections);let n=t.filter((e=>e.id===o));return null===o?null===l?g.index.contents.push(p):g.index.contents.splice(l,0,p):null===l?null===s?n[0].content.push(p):"monthlyLog"===n[0].objectType?n[0].days.filter((e=>e.id===s)).content.push(p):"futureLog"===n[0].objectType&&n[0].months.filter((e=>e.id===s)).content.push(p):null===s?n[0].content.splice(l,0,p):"monthlyLog"===n[0].objectType?n[0].days.filter((e=>e.id===s)).content.splice(l,0,p):"futureLog"===n[0].objectType&&n[0].months.filter((e=>e.id===s)).content.splice(l,0,p),g.textBlocks.push(d),e.put({_id:"0000",_rev:g._rev,email:g.email,pwd:g.pwd,theme:g.theme,index:g.index,dailyLogs:g.dailyLogs,monthlyLogs:g.monthlyLogs,futureLogs:g.futureLogs,collections:g.collections,trackers:g.trackers,imageBlocks:g.imageBlocks,audioBlocks:g.audioBlocks,textBlocks:g.textBlocks,tasks:g.tasks,events:g.events,signifiers:g.signifiers}).then((e=>{console.log(e)})).catch((e=>{u(e,null)}))}"task"===r?b(p,n,0,null,!1,((t,n)=>{t?(console.log(t),u(t,null)):(d.objectReference=n.id,v(((t,n)=>{if(!t){let t=[];Array.prototype.push.apply(t,n.dailyLogs),Array.prototype.push.apply(t,n.monthlyLogs),Array.prototype.push.apply(t,n.trackers),Array.prototype.push.apply(t,n.collections);let i=t.filter((e=>e.id===o));return null===o?null===l?n.index.contents.push(p):n.index.contents.splice(l,0,p):null===l?null===s?i[0].content.push(p):"monthlyLog"===i[0].objectType?i[0].days.filter((e=>e.id===s)).content.push(p):"futureLog"===i[0].objectType&&i[0].months.filter((e=>e.id===s)).content.push(p):null===s?i[0].content.splice(l,0,p):"monthlyLog"===i[0].objectType?i[0].days.filter((e=>e.id===s)).content.splice(l,0,p):"futureLog"===i[0].objectType&&i[0].months.filter((e=>e.id===s)).content.splice(l,0,p),n.textBlocks.push(d),e.put({_id:"0000",_rev:n._rev,email:n.email,pwd:n.pwd,theme:n.theme,index:n.index,dailyLogs:n.dailyLogs,monthlyLogs:n.monthlyLogs,futureLogs:n.futureLogs,collections:n.collections,trackers:n.trackers,imageBlocks:n.imageBlocks,audioBlocks:n.audioBlocks,textBlocks:n.textBlocks,tasks:n.tasks,events:n.events,signifiers:n.signifiers}).then((e=>{console.log(e)})).catch((e=>{console.log(e),u(e,null)}))}u(t,null)})))})):"event"===r&&k(n,p,h,null,!0,((t,n)=>{t?u(t,null):(d.objectReference=n.id,v(((t,n)=>{if(!t){let t=[];Array.prototype.push.apply(t,n.dailyLogs),Array.prototype.push.apply(t,n.monthlyLogs),Array.prototype.push.apply(t,n.trackers),Array.prototype.push.apply(t,n.collections);let i=t.filter((e=>e.id===o));return null===o?null===l?n.index.contents.push(p):n.index.contents.splice(l,0,p):null===l?null===s?i[0].content.push(p):"monthlyLog"===i[0].objectType?i[0].days.filter((e=>e.id===s)).content.push(p):"futureLog"===i[0].objectType&&i[0].months.filter((e=>e.id===s)).content.push(p):null===s?i[0].content.splice(l,0,p):"monthlyLog"===i[0].objectType?i[0].days.filter((e=>e.id===s)).content.splice(l,0,p):"futureLog"===i[0].objectType&&i[0].months.filter((e=>e.id===s)).content.splice(l,0,p),n.textBlocks.push(d),e.put({_id:"0000",_rev:n._rev,email:n.email,pwd:n.pwd,theme:n.theme,index:n.index,dailyLogs:n.dailyLogs,monthlyLogs:n.monthlyLogs,futureLogs:n.futureLogs,collections:n.collections,trackers:n.trackers,imageBlocks:n.imageBlocks,audioBlocks:n.audioBlocks,textBlocks:n.textBlocks,tasks:n.tasks,events:n.events,signifiers:n.signifiers}).then((e=>{console.log(e)})).catch((e=>{console.log(e),u(e,null)}))}u(t,null)})))}))}})).then((e=>{e.ok&&(console.log(d),u(null,d))}))}(m,e,o,s,l,n,i,r,a,c,((e,t)=>{h&&f(),u(e,t)}))}(this.controller.parent.id,this.controller.subParent,this.controller.currentBlockIndex,e.textContent,this.tabLevel,this.kind,null,this.signifier.id,o,!0,((e,t)=>{e||(this.item=t),console.log(e)}))},e.addEventListener("input",(()=>{let t=e.innerHTML;if("event"===this.kind&&(t.includes("@")&&(e.innerHTML=t.replace(/(@)/g,"&#128368;  "),t=e.innerHTML,this.moveToSpot(1e6,!0)),t.includes("#")&&(e.innerHTML=t.replace(/(#)/g,"&#128197;  "),t=e.innerHTML,this.moveToSpot(1e6,!0))),this.setCurrentSpot(),this.timeSetter=!1,this.dateSetter=!1,me(this,e.textContent,!0),"event"===this.kind){let t="";this.timeSetter?this.dateSetter||(t=`${t} use # for weekdays or dates MM/DD/YY`):(t=`${t} use @ for time HH:MM`,this.dateSetter||(t=`${t} and # for weekdays or dates MM/DD/YY`)),e.setAttribute("dateFiller",t)}"#&nbsp;"===t?this.setupHeader1():"##&nbsp;"===t?this.setupHeader2():"###&nbsp;"===t?this.setupHeader3():"-&nbsp;"===t?this.setupNote():"--&nbsp;"===t?this.setupEvent():"=-&nbsp;"===t?this.setupTask():"<div><br></div>"===t?this.removeStyles():"<br>"===t?e.innerHTML="":""!==e.textContent&&(this.controller.resetPosition=!0)})),e.onfocus=()=>{this.controller.resetPosition=!1,this.setCurrentSpot();for(let e=0;e<this.editorIcons.childNodes.length-1;e++)this.editorIcons.childNodes[e].classList.remove("unfocusedIcons"),this.editorIcons.childNodes[e].classList.add("focusedIcons");this.controller.currentBlockIndex=this.controller.blockArray.indexOf(this),this.controller.currentTabLevel=this.tabLevel,this.classList.contains("noteContainer")||this.classList.contains("eventContainer")||"none"!==this.checkBox.style.display?(this.controller.creatingFromBullet={isTrue:!0,kind:this.kind},"event"===this.kind&&e.classList.add("eventNodateFocused")):this.controller.creatingFromBullet={isTrue:!1,kind:""}},e.onkeydown=t=>{let o=t.key||t.keyCode;if("Backspace"===o||"Delete"===o){let t=this.tabLevel>0,o=20*this.tabLevel,s=this.currentPointerSpot-o==10,l=this.currentPointerSpot-o==30&&this.classList.contains("noteContainer"),n=s||l;""===e.innerHTML&&'Type "/" to create a block'===e.getAttribute("placeholder")&&this.controller.blockArray.length>1?this.controller.removeBlock():""!==e.innerHTML&&"<br>"!==e.innerHTML||0!==this.tabLevel?t&&n&&(this.tabLevel-=1,this.setupTabLevel()):this.removeStyles()}else if("Enter"===o){let o=e.innerHTML;"/h1"===o?(this.setupHeader1(),t.preventDefault()):"/h2"===o?(this.setupHeader2(),t.preventDefault()):"/h3"===o?(this.setupHeader3(),t.preventDefault()):"/note"===o?(this.setupNote(),t.preventDefault()):"/event"===o?(this.setupEvent(),t.preventDefault()):"/task"===o?(this.setupTask(),t.preventDefault()):"/futurelog"===o?(alert("New Future Log will be created"),t.preventDefault()):"/monthlylog"===o?(alert("New Monthly Log will be created"),t.preventDefault()):"/dailylog"===o?(alert("New Daily Log will be created"),t.preventDefault()):"/collection"===o?(alert("New Collection will be created"),t.preventDefault()):"/tracker"===o?(L("Practice Tracker",[],Me.id,((e,t)=>{e?console.log(e):console.log(t)})),t.preventDefault()):(this.controller.resetPosition=!1,this.controller.addNewBlock(),t.preventDefault())}else if("ArrowDown"===o){let t=e.classList.contains("header1")?80:e.classList.contains("header2")?57:"note"===this.kind||"event"===this.kind||"task"===this.kind?47:42;this.currentPointerHeight>e.offsetHeight-t&&this.controller.moveToNextBlock()}else if("ArrowUp"===o){let t=e.classList.contains("header1")?50:e.classList.contains("header2")?36:28;this.currentPointerHeight<t+this.initialHeight&&this.controller.moveToPreviousBlock()}else if("Tab"===o)this.tabLevel+=1,this.setupTabLevel(),t.preventDefault();else if("@"===o&&"event"===this.kind)if(this.atPressed)t.stopPropagation(),t.preventDefault();else{this.eventDelete=!1,this.atPressed=!0,this.timeSetter=!0;let t="";this.timeSetter?this.dateSetter||(t=`${t} use # for weekdays or dates MM/DD/YY`):(t=`${t} use @ for time HH:MM`,this.dateSetter||(t=`${t} and # for weekdays or dates MM/DD/YY`)),e.setAttribute("dateFiller",t)}else if("#"===o&&"event"===this.kind)if(this.hashPressed)t.stopPropagation(),t.preventDefault();else{this.eventDelete=!1,this.hashPressed=!0,this.dateSetter=!0;let t="";this.timeSetter?this.dateSetter||(t=`${t} use # for weekdays or dates MM/DD/YY`):(t=`${t} use @ for time HH:MM`,this.dateSetter||(t=`${t} and # for weekdays or dates MM/DD/YY`)),e.setAttribute("dateFiller",t)}else(this.atPressed&&"event"===this.kind&&o.match(/[^0123456789:]/g)&&!ge.includes(o)||this.hashPressed&&"event"===this.kind&&o.match(/[.:"'=,`~|[{}]/g)&&!ge.includes(o))&&(t.stopPropagation(),t.preventDefault())},e.onkeyup=e=>{let t=e.key||e.keyCode;"ArrowRight"!==t&&"ArrowLeft"!==t&&"ArrowDown"!==t&&"ArrowUp"!==t||(this.setCurrentSpot(),"ArrowRight"!==t&&"ArrowLeft"!==t||(this.controller.resetPosition=!0))}}}window.customElements.define("text-block",ke);class be extends Object{constructor(e,t,o){super(),this.blockArray=[],this.creatingFromBullet={isTrue:!1,kind:""},this.currentTabLevel=0,this.resetPosition=!0,this.currentBlockIndex=0,this.container=e,this.parent=t,this.subParent=o}createNewBlock(e,t,o){let s=new ke(this,e,t,(e=>{e&&(this.currentBlockIndex<this.blockArray.length-1?(this.container.insertBefore(s,this.blockArray[this.currentBlockIndex+1]),this.blockArray.splice(this.currentBlockIndex+1,0,s),this.currentBlockIndex+=1):(this.container.appendChild(s),this.blockArray.push(s),this.currentBlockIndex=this.blockArray.length-1),s.focus(),o(s))}))}addNewBlock(e){let t=new ke(this,e,this.generalSignifier,(e=>{e&&(this.currentBlockIndex<this.blockArray.length-1?(this.container.insertBefore(t,this.blockArray[this.currentBlockIndex+1]),this.blockArray.splice(this.currentBlockIndex+1,0,t),this.currentBlockIndex+=1):(this.container.appendChild(t),this.blockArray.push(t),this.currentBlockIndex=this.blockArray.length-1),t.focus())}))}moveToNextBlock(){let e=this.blockArray[this.currentBlockIndex];this.currentBlockIndex<this.blockArray.length-1&&this.blockArray[this.currentBlockIndex+1].moveToSpot(e.currentPointerSpot,!1)}moveToPreviousBlock(){let e=this.blockArray[this.currentBlockIndex];this.currentBlockIndex>0&&this.blockArray[this.currentBlockIndex-1].moveToSpot(e.currentPointerSpot,!0)}removeBlock(){let e=this.blockArray[this.currentBlockIndex];this.blockArray.splice(this.currentBlockIndex,1),this.currentBlockIndex=0===this.currentBlockIndex?this.currentBlockIndex:this.currentBlockIndex-1,console.log(this.currentBlockIndex);let t=this.blockArray[this.currentBlockIndex];console.log(t),t.moveToSpot(1e5,!1),this.container.removeChild(e)}}function Le(e,t,o,s,l){if(o<t.length){let n=s.filter((e=>e.id===t[o].signifier))[0];e.createNewBlock(t[o],n,(s=>{s.tabLevel=t[o].tabLevel,s.setupTabLevel(),"note"===t[o].kind?(s.setupNote(),s.item=t[o],s.shadowRoot.getElementById("textBlock").innerText=t[o].text,Le(e,t,o+1,(e=>{l(e)}))):"event"===t[o].kind?(s.setupEvent(),s.item=t[o],s.shadowRoot.getElementById("textBlock").innerText=t[o].text,Le(e,t,o+1,(e=>{l(e)}))):"task"===t[o].kind?(console.log(t[o]),s.setupTask(),v(((n,i)=>{if(null===n){let n=i.tasks.filter((e=>e.id===t[o].objectReference))[0];console.log(n),1===n.complete&&(s.checkBox.setAttribute("checked","checked"),s.shadowRoot.getElementById("textBlock").classList.add("crossed")),s.item=t[o],s.shadowRoot.getElementById("textBlock").innerText=t[o].text,Le(e,t,o+1,(e=>{l(e)}))}else console.log(n)}))):"h1"===t[o].kind?(s.setupHeader1(),s.item=t[o],s.shadowRoot.getElementById("textBlock").innerText=t[o].text,Le(e,t,o+1,(e=>{l(e)}))):"h2"===t[o].kind?(s.setupHeader2(),s.item=t[o],s.shadowRoot.getElementById("textBlock").innerText=t[o].text,Le(e,t,o+1,(e=>{l(e)}))):"h3"===t[o].kind?(s.setupHeader3(),s.item=t[o],s.shadowRoot.getElementById("textBlock").innerText=t[o].text,Le(e,t,o+1,(e=>{l(e)}))):(s.item=t[o],s.shadowRoot.getElementById("textBlock").innerText=t[o].text,Le(e,t,o+1,(e=>{l(e)})))}))}else l("done populating items")}function ve(e,t,o,s){Le(e,t,0,o,(e=>{s(e)}))}function we(e,t,o,s){let l=new be(e,t,o);setTimeout((()=>{let n=null,i=[];v(((r,a)=>{if(r)s(r);else{let r=[];Array.prototype.push.apply(r,a.dailyLogs),Array.prototype.push.apply(r,a.monthlyLogs),Array.prototype.push.apply(r,a.futureLogs),Array.prototype.push.apply(r,a.collections),Array.prototype.push.apply(r,a.trackers);let c=a.signifiers.filter((e=>"general"===e.meaning))[0];if(l.generalSignifier=c,null===t||"dailyLog"!==t.objectType&&"collection"!==t.objectType){let t=new ke(l,null,c,(o=>{o?(e.appendChild(t),l.blockArray.push(t),l.currentBlockIndex=l.blockArray.length-1,t.removeStyles(),t.focus(),console.log("newblock created successfully")):console.log("newBlock not being created"),s(l)}))}else{let d=r.filter((e=>e.id===t.id));if(d.length>0){n=d[0];let t=a.textBlocks;if(null===o)for(let e=0;e<n.content.length;e++)Array.prototype.push.apply(i,t.filter((t=>t.id===n.content[e])));else if("monthlyLog"===n.objectType){let e=n.days.filter((e=>e.id===o));for(let o=0;o<e.content.length;o++)Array.prototype.push.apply(i,t.filter((t=>t.id===e.content[o])))}else if("futureLog"===n.objectType){let e=n.months.filter((e=>e.id===o));for(let o=0;o<e.content.length;o++)Array.prototype.push.apply(i,t.filter((t=>t.id===e.content[o])))}ve(l,i,a.signifiers,(t=>{if("done populating items"===t){let t=new ke(l,null,c,(o=>{o&&(e.appendChild(t),l.blockArray.push(t),l.currentBlockIndex=l.blockArray.length-1,t.removeStyles(),t.focus()),s(l)}))}}))}}}}))}),80)}let Be=D("template",null,D("link",{type:"text/css",rel:"stylesheet",href:"trackerBlock.css"}),D("div",{id:"container"},D("div",{id:"editorIcons",class:"paragraphIcons"},D("img",{src:"../public/resources/plusIcon.png",class:"unfocusedIcons"}),D("img",{src:"../public/resources/sixDotIcon.png",class:"unfocusedIcons"})),D("div",{id:"title"},"Test")));class Ae extends HTMLElement{constructor(e,t,o,s){super(),this.parent=t,this.item=o,this.trackerMenu=s,this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(Be.content.cloneNode(!0)),this.trackerButton=this.shadowRoot.querySelector(".plus"),this.plusButton=this.shadowRoot.querySelector("#editorIcons img"),this.plusButton=this.shadowRoot.querySelector("#editorIcons img + img"),this.titleSpan=this.shadowRoot.getElementById("title"),this.titleSpan.innerHTML=e}connectedCallback(){this.plusButton.onclick=()=>{this.createTracker()},this.titleSpan.onclick=()=>{this.trackerMenu.clear(),this.trackerMenu.title=this.titleSpan.innerHTML,this.trackerMenu.isInsideTracker=!0,we(this.trackerMenu.shadowRoot.getElementById("editor"),this.item,null,(e=>{e||console.log("Error loading tracker")}))}}createTracker(){L(this.title.innerHTML,[],this.parent,!0,((e,t)=>{e?console.log(e):console.log(t)}))}}window.customElements.define("tracker-block",Ae);let xe=D("template",null,D("link",{type:"text/css",rel:"stylesheet",href:"tracker.css"}),D("div",{class:"wrapper closed"},D("div",{class:"tracker_header"},D("button",{class:"close_button"}," ",D("img",{src:"../public/resources/right-chevron.png"})," "),D("h1",{class:"tracker_h1"},"Future Log Tracker")),D("div",{class:"tracker_menu"},D("div",{id:"editor"}))));class Te extends HTMLElement{static get observedAttributes(){return["open"]}constructor(e){super(),this.attachShadow({mode:"open"}),this.close=this.close.bind(this),this.clear=this.clear.bind(this),this.shadowRoot.appendChild(xe.content.cloneNode(!0)),this.title=e,this.closeButton=this.shadowRoot.querySelector(".close_button"),this.editor=this.shadowRoot.getElementById("editor"),this.isInsideTracker=!1}attributeChangedCallback(e,t,o){t!==o&&(this[e]=this.hasAttribute(e))}connectedCallback(){this.closeButton.addEventListener("click",(()=>{if(this.isInsideTracker){this.isInsideTracker=!1,this.clear();let e=this.shadowRoot.getElementById("editor");v(((t,o)=>{if(t)console.log(t);else{let t=o.trackers,s=[];for(let e=0;e<Me.trackers.length;e++)console.log("hello"),s.push(t.filter((t=>t.id===Me.trackers[e]))[0]);console.log(s),setTimeout((()=>{for(let t=0;t<s.length;t++){let o=s[t],l=new Ae(o.title,Me.id,o,this);e.appendChild(l)}e.appendChild(new M)}),10)}})),"futureLog"===Me.objectType?this.title="Future Log Trackers":"monthlyLog"===Me.objectType?this.title="Monthly Log Trackers":this.title="Daily Log Trackers"}else this.close()}))}toggle(){this.open=!this.open}get open(){return this.hasAttribute("open")}set open(e){this.shadowRoot.querySelector(".wrapper").classList.toggle("open",e),this.shadowRoot.querySelector(".wrapper").classList.toggle("closed",!e),this.shadowRoot.querySelector(".wrapper").setAttribute("aria-hidden",!e),e?(this.setAttribute("open","true"),this.focus()):this.removeAttribute("open")}get title(){return this.shadowRoot.querySelector(".tracker_header h1").innerText}set title(e){this.shadowRoot.querySelector(".tracker_header h1").innerText=e}close(){this.open=!1}clear(){for(;this.editor.childNodes.length>0;)this.editor.childNodes[0].remove()}}window.customElements.define("tracker-menu",Te),document.querySelector("body").style.display="none";let Ie=new K,Se=new Z,De="",Ee=1,Me={},Fe=document.getElementById("contentWrapper");function Ce(e){let t="",o=null;null!==e&&(t=e.split("~")),console.log(void 0!==t),void 0!==t&&(o=t[1]),v(((e,t)=>{if(e)window.location.href="/login";else if(null==o)Me=t.index;else{let e=[];Array.prototype.push.apply(e,t.dailyLogs),Array.prototype.push.apply(e,t.monthlyLogs),Array.prototype.push.apply(e,t.futureLogs),Array.prototype.push.apply(e,t.collections);let s=e.filter((e=>e.id===o));Me=s[0]}}))}function Re(e){v(((e,t)=>{if(e)console.log(e);else{console.log(t.futureLogs);let e=[];Array.prototype.push.apply(e,t.futureLogs),Array.prototype.push.apply(e,t.collections);let o=[];console.log(Me);for(let t=0;t<Me.contents.length;t++)Array.prototype.push.apply(o,e.filter((e=>e.id===Me.contents[t])));let s=["January","February","March","April","May","June","July","August","September","October","November","December"];for(let e=0;e<o.length;e++)if(console.log("inside for loop"),"futureLog"===o[e].objectType){console.log("inside if stmt");let l=new Date(o[e].startDate),n=new Date(o[e].endDate),i=new _(`Future Log ${s[l.getMonth()]} ${l.getFullYear()} - ${s[n.getMonth()]} ${n.getFullYear()}`,o[e],1);Fe.appendChild(i),e>0&&i.titleWrapper.classList.add("singleItemWrapper");for(let l=0;l<o[e].months.length;l++){let n=t.monthlyLogs.filter((t=>t.id===o[e].months[l].monthlyLog))[0],r=new _(`${s[new Date(n.date).getMonth()]} ${new Date(n.date).getFullYear()}`,n,2);i.contentWrapper.appendChild(r);for(let e=0;e<n.days.length;e++){let o=t.dailyLogs.filter((t=>t.id===n.days[e].dailyLog))[0],l=new _(`${["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][new Date(o.date).getDay()]}, ${s[new Date(o.date).getMonth()]} ${new Date(o.date).getUTCDate()}`,o,3);r.contentWrapper.appendChild(l)}}}Fe.appendChild(new M)}})),console.log("we are here"),Se.title="Index",De="/",Ee=1;for(let t=0;t<e.length;t++)e[t].removeAttribute("disabled"),e[t].style.visibility="visible";document.getElementById("targetMenu").style.display="none",Ie.target.setAttribute("disabled","disabled"),Ie.target.style.visibility="hidden",Ie.single.setAttribute("disabled","disabled"),Ie.single.style.visibility="hidden",Ie.double.setAttribute("disabled","disabled"),Ie.double.style.visibility="hidden",Ie.singleMenu.setAttribute("disabled","disabled"),Ie.singleMenu.style.visibility="hidden",Ie.doubleMenu.setAttribute("disabled","disabled"),Ie.doubleMenu.style.visibility="hidden";let t=Se.imgbuttons;for(let e=0;e<t.length;e++)t[e].classList.contains("plus")||t[e].classList.add("hide")}function Ne(e,t){v(((e,t)=>{if(e)console.log(e);else{let e=t.monthlyLogs;console.log(Me);let o=[];for(let t=0;t<Me.months.length;t++)Array.prototype.push.apply(o,e.filter((e=>e.id===Me.months[t].monthlyLog)));let s=["January","February","March","April","May","June","July","August","September","October","November","December"];for(let e=0;e<o.length;e++){let l=o[e],n=new _(`${s[new Date(l.date).getMonth()]} ${new Date(l.date).getFullYear()}`,l,1);Fe.appendChild(n),e>0&&n.titleWrapper.classList.add("singleItemWrapper");for(let e=0;e<l.days.length;e++){let o=t.dailyLogs.filter((t=>t.id===l.days[e].dailyLog))[0],i=new _(`${["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][new Date(o.date).getDay()]}, ${s[new Date(o.date).getMonth()]} ${new Date(o.date).getUTCDate()}`,o,2);n.contentWrapper.appendChild(i)}}Fe.appendChild(new M)}})),document.getElementById("targetMenu").style.display="block";let o=new Date(Me.startDate),s=new Date(Me.endDate);Se.title=s.getFullYear()===o.getFullYear()?`Future Log ${o.getFullYear()}`:`Future Log ${o.getFullYear()} - ${s.getFullYear()}`,Ee=4,De=t;for(let t=0;t<e.length;t++)e[t].removeAttribute("disabled"),e[t].style.visibility="visible";Ie.single.setAttribute("disabled","disabled"),Ie.single.style.visibility="hidden",Ie.double.setAttribute("disabled","disabled"),Ie.double.style.visibility="hidden",Ie.singleMenu.setAttribute("disabled","disabled"),Ie.singleMenu.style.visibility="hidden",Ie.doubleMenu.setAttribute("disabled","disabled"),Ie.doubleMenu.style.visibility="hidden";let l=Se.imgbuttons;for(let e=0;e<l.length;e++)l[e].classList.remove("hide");let n=new Te("Future Log Trackers");document.getElementById("trackerWrapper").appendChild(n);let i=n.shadowRoot.getElementById("editor");v(((e,t)=>{if(e)console.log(e);else{let e=t.trackers,o=[];for(let t=0;t<Me.trackers.length;t++)o.push(e.filter((e=>e.id===Me.trackers[t]))[0]);console.log(o),setTimeout((()=>{for(let e=0;e<o.length;e++){let t=o[e],s=new Ae(t.title,Me.id,t,n);i.appendChild(s)}i.appendChild(new M)}),10)}}))}function He(e,t){v(((e,t)=>{if(e)console.log(e);else{let e=t.dailyLogs,o=[];for(let t=0;t<Me.days.length;t++)Array.prototype.push.apply(o,e.filter((e=>e.id===Me.days[t].dailyLog)));let s=["January","February","March","April","May","June","July","August","September","October","November","December"],l=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];for(let e=0;e<Me.days.length;e++){let t=o[e],n=new _(`${l[new Date(t.date).getDay()]}, ${s[new Date(t.date).getMonth()]} ${new Date(t.date).getUTCDate()}`,t,1);Fe.appendChild(n),e>0&&n.titleWrapper.classList.add("singleItemWrapper")}Fe.appendChild(new M)}})),Se.title=`${["January","February","March","April","May","June","July","August","September","October","November","December"][new Date(Me.date).getMonth()]} ${new Date(Me.date).getFullYear()}`,Ee=3,De=t;for(let t=0;t<e.length;t++)e[t].removeAttribute("disabled"),e[t].style.visibility="visible";document.getElementById("targetMenu").style.display="block",Ie.double.setAttribute("disabled","disabled"),Ie.double.style.visibility="hidden",Ie.doubleMenu.setAttribute("disabled","disabled"),Ie.doubleMenu.style.visibility="hidden";let o=Se.imgbuttons;for(let e=0;e<o.length;e++)o[e].classList.remove("hide");let s=new Te("Monthly Log Trackers");document.getElementById("trackerWrapper").appendChild(s);let l=s.shadowRoot.getElementById("editor");v(((e,t)=>{if(e)console.log(e);else{let e=t.trackers,o=[];for(let t=0;t<Me.trackers.length;t++)o.push(e.filter((e=>e.id===Me.trackers[t]))[0]);setTimeout((()=>{for(let e=0;e<o.length;e++){let t=o[e],n=new Ae(t.title,Me.id,t,s);l.appendChild(n)}l.appendChild(new M)}),10)}}))}function _e(e,t){Se.title=`${["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][new Date(Me.date).getDay()]} ${["January","February","March","April","May","June","July","August","September","October","November","December"][new Date(Me.date).getMonth()]} ${new Date(Me.date).getUTCDate()}, ${new Date(Me.date).getFullYear()}`,Ee=2,De=t;for(let t=0;t<e.length;t++)e[t].removeAttribute("disabled"),e[t].style.visibility="visible";we(Fe,Me,null,(e=>{console.log(e)})),document.getElementById("targetMenu").style.display="block";let o=Se.imgbuttons;for(let e=0;e<o.length;e++)o[e].classList.remove("hide");let s=new Te("Daily Log Trackers");document.getElementById("trackerWrapper").appendChild(s);let l=s.shadowRoot.getElementById("editor");v(((e,t)=>{if(e)console.log(e);else{let e=t.trackers,o=[];for(let t=0;t<Me.trackers.length;t++)console.log("hello"),o.push(e.filter((e=>e.id===Me.trackers[t]))[0]);console.log(o),setTimeout((()=>{for(let e=0;e<o.length;e++){let t=o[e],s=new Ae(t.title,Me.id,1);l.appendChild(s)}we(l,null,null,(e=>{console.log(e)}))}),10)}}))}document.getElementById("topbar").appendChild(Se),document.getElementById("sidebar").appendChild(Ie),document.getElementById("targetMenu").onclick=()=>{Ie.toggleTracker()},R.setState(document.location.hash,!1),window.onpopstate=()=>{R.setState(document.location.hash,!0)}})();